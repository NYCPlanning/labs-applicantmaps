<div class="cell sidebar">
  {{#if mapInstance}}
    {{#project-geometries-menu
      model=model
      mapInstance=mapInstance
      selectedLots=selectedLots
      lotSelectionMode=lotSelectionMode
      geometryMode=geometryMode
      as |menu|
    }}

      {{!-- Development Site --}}
{{!--       {{menu.draw-control
        mode='developmentSite'
        modeDisplayName='Development Site'
        tooltip="The Development Site refers to the zoning lot(s) to be improved by the specific development(s) that the land use actions would facilitate."
        hasGeom=model.developmentSite
        required=true
        doneAction=(action 'addProposedZoning')
      }} --}}

      {{!-- Project Area --}}
{{!--       {{menu.draw-control
        mode='projectArea'
        modeDisplayName='Project Area'
        tooltip="The Project Area refers to all properties that would be subject to the proposed actions. The Project Area should only be used if it is larger than the Development Site."
        hasGeom=model.projectArea
        disabled=model.developmentSite
      }} --}}

      {{!-- Proposed Zoning --}}
{{!--       {{menu.draw-control
        mode='proposedZoning'
        modeDisplayName='Zoning'
        hasGeom=model.proposedZoning
        resetAction=(action 'getClippedZoning')
        disabled=model.developmentSite
      }} --}}

      {{!-- Proposed Commercial Overlays --}}
{{!--       {{menu.draw-control
        mode='proposedCommercialOverlays'
        modeDisplayName='Commercial Overlays'
        hasGeom=model.proposedCommercialOverlays
        resetAction=(action 'getClippedCommercialOverlays')
        disabled=model.developmentSite
      }} --}}

      {{!-- Proposed Special Purpose Districts --}}
{{!--       {{menu.draw-control
        mode='proposedSpecialPurposeDistricts'
        modeDisplayName='Special Purpose Districts'
        hasGeom=model.proposedSpecialPurposeDistricts
        resetAction=(action 'getClippedSpecialPurposeDistricts')
        disabled=model.developmentSite
      }}
 --}}
      {{!-- Rezoning Area --}}
{{!--       {{menu.draw-control
        mode='rezoningArea'
        modeDisplayName='Rezoning Area'
        tooltip="When drawing, the Rezoning Area Boundary should be graphically offset from the proposed Zoning District Boundaries. This area refers to all property subject to the proposed amendment to existing Zoning Districts and Boundaries."
        hasGeom=model.rezoningArea
        disabled=model.developmentSite
      }}
 --}}
    {{/project-geometries-menu}}
  {{/if}}

  {{!-- EMBER WORMHOLE CONTAINER --}}
  {{!-- The geometry type component will fill this div with markup once invoked --}}
  <div id="geometry-type-draw-explainer">
  </div>

  {{!-- EMBER WORMHOLE CONTAINER --}}
  <div id="geometry-type-save-box">
  </div>

</div>
<div class="cell large-auto map-container">
  {{#project-map-form tagName='' as |projectMapForm|}}
    {{#labs-map
      id='main-map'
      initOptions=(hash
        style=projectMapForm.model.meta.mapboxStyle
        zoom=12
        center=(array -73.983307 40.704977)
      )
      mapLoaded=(action handleMapLoad) as |map|}}

      {{search-handler map=map}}

      {{!-- labs-layers (includes tax-lots layer) --}}
      {{#map.labs-layers
        layerGroups=projectMapForm.model.layerGroups
        as |layers|}}
        {{#layers.tooltip as |tooltip|}}
          {{tooltip-renderer
            feature=tooltip.feature
            template=tooltip.layer.tooltipTemplate}}
        {{/layers.tooltip}}
      {{/map.labs-layers}}

      {{!-- invoke the component for the specified draw mode --}}
      {{project-geometry-edit/development-site
        model=model
        mode=mode
        map=map}}

      {{#if (and geometryMode (not lotSelectionMode))}}
        {{#if showDrawInstructions}}
          <div class="draw-instructions">
            <button class="float-right" type="button" onclick={{action 'hideInstructions'}} style="margin:0 6px 0 10px;">
              {{fa-icon 'times' class="red-dark"}}
            </button>
            <ul class="text-tiny">
              <li>Select the polygon tool to begin drawing a new shape (you can draw multiple shapes)</li>
              <li>Complete a shape by clicking the final vertex a second time</li>
              <li>Edit a completed shape by selecting then dragging vertices</li>
              <li>Delete a shape by clicking on the trash button on the draw controls to the left</li>
              <li>Use the trash button (or delete key) to delete the shape or a selected vertex</li>
            </ul>
          </div>
        {{else}}
          <button class="draw-instructions-button" onclick={{action 'showInstructions'}}>{{fa-icon 'comment-alt'}}</button>
        {{/if}}
      {{/if}}

      {{!-- Ad-hoc source and layer for projectArea --}}
{{!--       {{#if (and model.projectArea (not-eq geometryMode 'projectArea'))}}
        {{#map.source options=(mapbox-geojson-source model.projectArea) as |source|}}
          {{source.layer
            layer=projectGeomLayers.projectAreaLayer
            before='boundary_country'
          }}
        {{/map.source}}
      {{/if}} --}}

      {{!-- Ad-hoc source and layer for projectArea --}}
{{!--       {{#if (and model.rezoningArea (not-eq geometryMode 'rezoningArea'))}}
        {{#map.source options=(mapbox-geojson-source model.rezoningArea) as |source|}}
          {{source.layer
            layer=projectGeomLayers.rezoningAreaLayer
            before='boundary_country'
          }}
        {{/map.source}}
      {{/if}} --}}

      {{!-- Ad-hoc source and layer for showing zoning --}}
{{!--       {{#if (and model.proposedZoning (not-eq geometryMode 'proposedZoning') model.developmentSite)}}
        {{#map.source options=(mapbox-geojson-source model.proposedZoning) as |source|}}
          {{source.layer
            layer=projectGeomLayers.proposedZoningLayer
            before='boundary_country'
          }}
          {{source.layer
            layer=projectGeomLayers.proposedZoningLabelsLayer
            before='boundary_country'
          }}
        {{/map.source}}
      {{/if}} --}}

      {{!-- Ad-hoc source and layer for showing commercial overlays --}}
{{!--       {{#if (and model.proposedCommercialOverlays (not-eq geometryMode 'proposedCommercialOverlays') model.developmentSite)}}
        {{#map.source options=(mapbox-geojson-source model.proposedCommercialOverlays) as |source|}}
          {{source.layer layer=projectGeomLayers.coLayer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c11Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c12Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c13Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c14Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c15Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c21Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c22Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c23Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c24Layer before='boundary_country'}}
          {{source.layer layer=projectGeomLayers.c25Layer before='boundary_country'}}
        {{/map.source}}
      {{/if}} --}}

      {{!-- Ad-hoc source and layer for showing commercial overlays --}}
{{!--       {{#if (and model.proposedSpecialPurposeDistricts (not-eq geometryMode 'proposedSpecialPurposeDistricts') model.developmentSite)}}
        {{#map.source options=(mapbox-geojson-source model.proposedSpecialPurposeDistricts) as |source|}}
          {{source.layer
            layer=projectGeomLayers.proposedSpecialPurposeDistrictsLayer
            before='boundary_country'
          }}
          {{source.layer
            layer=projectGeomLayers.proposedSpecialPurposeDistrictsLabelsLayer
            before='boundary_country'
          }}
        {{/map.source}}
      {{/if}} --}}
    {{/labs-map}}
  {{/project-map-form}}
</div>
