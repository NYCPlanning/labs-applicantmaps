{{!-- add the development-specific tax-lots layergroup --}}
{{#map.labs-layers
  layerGroups=(array taxLots)
  onLayerClick=(if (eq mode 'lots') (action 'handleLayerClick') (action 'noop'))
  as |layers|}}
  {{#layers.tooltip as |tooltip|}}
    {{tooltip-renderer
      feature=tooltip.feature
      template=tooltip.layer.tooltipTemplate}}
  {{/layers.tooltip}}
{{/map.labs-layers}}

{{!-- if in lot selection mode, display the selected lots --}}
{{#if (eq mode 'lots')}}
  {{!-- Ad-hoc source and layer for showing selected lots in lot selection mode --}}
  {{#map.source options=selectedLotsSource as |source|}}
    {{source.layer
      layer=selectedLotsLayer
      before='boundary_country'
    }}
  {{/map.source}}
{{/if}}

{{!-- render markup into parent container --}}
{{#ember-wormhole to='geometry-type-save-box'}}
  {{#if hasBlock}}
    {{yield (hash
      finalGeometry=finalGeometry 
      button=(component 'project-geometry-edit/draw-lots-to-union/button'
        enabled=isReady
        finalGeometry=finalGeometry))}}
  {{else}}
    {{project-geometry-edit/draw-lots-to-union/button
      enabled=isReady
      finalGeometry=finalGeometry
    }}
  {{/if}}
{{/ember-wormhole}}
